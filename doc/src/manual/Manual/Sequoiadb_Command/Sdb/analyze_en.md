##NAME##

analyze - collect statistics

##SYNOPSIS##

**db.analyze([options])**

##CATEGORY##

Sdb

##DESCRIPTION##

This function is used to analyze the data of collection and index, and collect [statistics][statistics].

##PARAMETERS##

options ( *object, optional* )

Specify analysis mode, collection space, and command location parameters through the parameter "options":

- Mode ( *number* ): Analysis mode and the default is 1.

    The values are as follows:

    - 1: Perform sampling analysis and generate statistical information.
    - 2: Perform full data analysis and generate statistical information.
    - 3: Generate statistics for default field values.
    - 4: Load statistics into the cache.
    - 5: Clear the statistics in the cache.

    When Mode is 1~3, it must be executed on the primary data node. When taking 3, the parameter "Collection" must be specified, and the statistics of this collection and all indexes are generated by default. If the parameter "Index" is specified at the same time, the statistical information of the collection and the specified index will be generated.

    Format: `Mode: 1`

- CollectionSpace ( *string* ): Collection space name and the default is empty.

    This parameter cannot be used together with the parameter "Collection".

    Format: `CollectionSpace: "sample"`

- Collection ( *string* ): Collection name and the default is empty.

    This parameter cannot be used together with the parameter "CollecitonSpace", and the full name of the collection must be specified.

    Format: `Collection: "sample.employee"`

- Index ( *string* ): Index name and the default is empty.

    When specifying this parameter, users need to specify the parameters "Collection".

    Format: `Index: "index"`

- SampleNum ( *number* ): The number of sampled data, the range is 100~10000 and the default value is 200.

    This parameter cannot be used together with the parameter "SamplePercent".

    Format: `SampleNum: 1000`

- SamplePercent ( *number* ): The sampling ratio and the range is 0.0~100.0.

    - This parameter cannot be used together with the parameter "SampleNum". This parameter is not used by default, and the default value 200 of the parameter "SampleNum" is selected.
    - The number of sampled data is the product of the number of aggregated data and the ratio, ranging from 100 to 10,000 (if it is less than 100, adjust it to 100; if it is greater than 10,000, adjust it to 10,000).

    Format: `SamplePercent: 50`

- Location Elements

    Command position parameter item, refer to [Location Elements][Location Elements]

    Format: `GroupName: "db1"`

##RETURN VALUE##

When the function executes successfully, there is no return value.

When the function fails, an exception will be thrown and an error message will be printed.

##ERRORS##

The common exceptions of `analyze()` function are as follows:

| Error Code | Error Type | Description | Solution |
| ------ | --- | ------------ | ----------- |
| -34 | SDB_DMS_CS_NOTEXIST | Collection space does not exist| Check whether the collection space exists|
| -23 | SDB_DMS_NOTEXIST    | The specified collection does not exist| Check whether the collection exists|
| -47 | SDB_IXM_NOTEXIST | The specified index does not exist | Retry the operation, if the fault is not repaired, users need to contact the after-sales engineer to repair.|
| -6  | SDB_INVALIDARG | The specified parameters may conflict, refer to the description of options | Check the diagnostic log of the corresponding node, find the detailed description of the parameter error, correct it and try again.|

When the exception happens, use [getLastErrMsg()][getLastErrMsg] to get the error message or use [getLastError()][getLastError] to get the [error code][error_code]. For more details, refer to [Troubleshooting][faq].

##VERSION##

v2.9 and above

##EXAMPLES##

- Analyze and collect statistical information of all collection spaces.

    ```lang-javascript
    > db.analyze()
    ```

- Analyze and collect statistical information of the specified collection space "sample".

    ```lang-javascript
    > db.analyze({CollectionSpace: "sample"})
    ```

- Analyze and collect statistical information of the specified data group "group1".

    ```lang-javascript
    > db.analyze({GroupName: "group1"})
    ```

- Collect statistics of the specified collection "sample.employee", and specify the parameter "SampleNum".

    ```lang-javascript
    > db.analyze({Collection: "sample.employee", SampleNum: 1000})
    ```

- Collect statistics of the index "index" of the specified collection "sample.employee".

    ```lang-javascript
    > db.analyze({Collection: "sample.employee", Index: "index"})
    ```

- Generate and empty the statistics cache for the specified collection "sample.employee".

    ```lang-javascript
    > db.analyze({Collection: "sample.employee", Mode: 5})
    ```

[^_^]:
     Links
[Location Elements]:manual/Manual/Sequoiadb_Command/location.md
[statistics]:manual/Distributed_Engine/Maintainance/Access_Plan/statistics.md
[list_info]:manual/Manual/List/list.md
[getLastErrMsg]:manual/Manual/Sequoiadb_Command/Global/getLastErrMsg.md
[getLastError]:manual/Manual/Sequoiadb_Command/Global/getLastError.md
[faq]:manual/FAQ/faq_sdb.md
[error_code]:manual/Manual/Sequoiadb_error_code.md