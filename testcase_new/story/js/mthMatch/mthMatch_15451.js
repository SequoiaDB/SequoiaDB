/************************************
*@Description: use gt/gte/lt/lte/ne to check Infinity/-Infinity
*@author:      zhaoyu
*@createdate:  2018.7.19
*@testlinkCase:seqDB-15451
**************************************/
main( test );
function test ()
{
   //clean environment before test
   commDropCL( db, COMMCSNAME, COMMCLNAME, true, true, "drop CL in the beginning" );

   //create cl
   var dbcl = commCreateCL( db, COMMCSNAME, COMMCLNAME );

   //create index
   commCreateIndex( dbcl, "a", { a: 1 } );

   //insert data 
   var doc = [{ No: 1, a: 1.7e+308 },
   { No: 2, a: 1.7e+309 },
   { No: 3, a: -1.7e+308 },
   { No: 4, a: -1.7e+309 },
   { No: 5, a: { $decimal: "1.7e+310" } },
   { No: 6, a: { $decimal: "-1.7e+310" } },
   { No: 7, a: Infinity },
   { No: 8, a: -Infinity }];
   dbcl.insert( doc );

   var expRecs = [{ No: 1, a: 1.7e+308 },
   { No: 2, a: Infinity },
   { No: 3, a: -1.7e+308 },
   { No: 4, a: -Infinity },
   { No: 5, a: { $decimal: "17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { No: 6, a: { $decimal: "-17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { No: 7, a: Infinity },
   { No: 8, a: -Infinity }];
   checkResult( dbcl, null, {}, expRecs, { No: 1 } );

   var expRecs = [{ No: 1, a: "double" },
   { No: 2, a: "double" },
   { No: 3, a: "double" },
   { No: 4, a: "double" },
   { No: 5, a: "decimal" },
   { No: 6, a: "decimal" },
   { No: 7, a: "double" },
   { No: 8, a: "double" }];
   checkResult( dbcl, null, { a: { $type: 2 } }, expRecs, { No: 1 } );

   hints = [{ '': null }, { '': '' }];

   for( var i = 0; i < hints.length; i++ )
   {
      hintCondition = hints[i];

      //$gt:-Infinity
      var findCondition = { a: { $gt: -Infinity } };
      var expRecs = [{ No: 1, a: 1.7e+308 },
      { No: 2, a: Infinity },
      { No: 3, a: -1.7e+308 },
      { No: 5, a: { $decimal: "17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 6, a: { $decimal: "-17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 7, a: Infinity }];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$lt:-Infinity
      var findCondition = { a: { $lt: -Infinity } };
      var expRecs = [];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$et:-Infinity
      var findCondition = { a: { $et: -Infinity } };
      var expRecs = [{ No: 4, a: -Infinity },
      { No: 8, a: -Infinity }];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$ne:-Infinity
      var findCondition = { a: { $ne: -Infinity } };
      var expRecs = [{ No: 1, a: 1.7e+308 },
      { No: 2, a: Infinity },
      { No: 3, a: -1.7e+308 },
      { No: 5, a: { $decimal: "17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 6, a: { $decimal: "-17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 7, a: Infinity },];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$gt:Infinity
      var findCondition = { a: { $gt: Infinity } };
      var expRecs = [];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$lt:Infinity
      var findCondition = { a: { $lt: Infinity } };
      var expRecs = [{ No: 1, a: 1.7e+308 },
      { No: 3, a: -1.7e+308 },
      { No: 4, a: -Infinity },
      { No: 5, a: { $decimal: "17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 6, a: { $decimal: "-17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 8, a: -Infinity }];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$et:Infinity
      var findCondition = { a: { $et: Infinity } };
      var expRecs = [{ No: 2, a: Infinity },
      { No: 7, a: Infinity }];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$ne:Infinity
      var findCondition = { a: { $ne: Infinity } };
      var expRecs = [{ No: 1, a: 1.7e+308 },
      { No: 3, a: -1.7e+308 },
      { No: 4, a: -Infinity },
      { No: 5, a: { $decimal: "17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 6, a: { $decimal: "-17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 8, a: -Infinity }];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$gt:12.123
      var findCondition = { a: { $gt: 12.123 } };
      var expRecs = [{ No: 1, a: 1.7e+308 },
      { No: 2, a: Infinity },
      { No: 5, a: { $decimal: "17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 7, a: Infinity }];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$lt:Infinity
      var findCondition = { a: { $lt: 12.123 } };
      var expRecs = [{ No: 3, a: -1.7e+308 },
      { No: 4, a: -Infinity },
      { No: 6, a: { $decimal: "-17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 8, a: -Infinity }];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$et:Infinity
      var findCondition = { a: { $et: 12.123 } };
      var expRecs = [];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$ne:Infinity
      var findCondition = { a: { $ne: 12.123 } };
      var expRecs = [{ No: 1, a: 1.7e+308 },
      { No: 2, a: Infinity },
      { No: 3, a: -1.7e+308 },
      { No: 4, a: -Infinity },
      { No: 5, a: { $decimal: "17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 6, a: { $decimal: "-17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 7, a: Infinity },
      { No: 8, a: -Infinity }];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$gt:12.123
      var findCondition = { a: { $gt: -1.7e+311 } };
      var expRecs = [{ No: 1, a: 1.7e+308 },
      { No: 2, a: Infinity },
      { No: 3, a: -1.7e+308 },
      { No: 5, a: { $decimal: "17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 6, a: { $decimal: "-17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 7, a: Infinity }];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$lt:Infinity
      var findCondition = { a: { $lt: -1.7e+311 } };
      var expRecs = [];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$et:Infinity
      var findCondition = { a: { $et: -1.7e+311 } };
      var expRecs = [{ No: 4, a: -Infinity },
      { No: 8, a: -Infinity }];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

      //$ne:Infinity
      var findCondition = { a: { $ne: -1.7e+311 } };
      var expRecs = [{ No: 1, a: 1.7e+308 },
      { No: 2, a: Infinity },
      { No: 3, a: -1.7e+308 },
      { No: 5, a: { $decimal: "17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 6, a: { $decimal: "-17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
      { No: 7, a: Infinity }];
      checkResult( dbcl, findCondition, null, expRecs, { No: 1 } );

   }

   dbcl.remove( { a: Infinity } );
   var expRecs = [{ No: 1, a: 1.7e+308 },
   { No: 3, a: -1.7e+308 },
   { No: 4, a: -Infinity },
   { No: 5, a: { $decimal: "17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { No: 6, a: { $decimal: "-17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { No: 8, a: -Infinity }];
   checkResult( dbcl, null, null, expRecs, { No: 1 } );


   dbcl.remove( { a: -1.7e+311 } );
   var expRecs = [{ No: 1, a: 1.7e+308 },
   { No: 3, a: -1.7e+308 },
   { No: 5, a: { $decimal: "17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { No: 6, a: { $decimal: "-17000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   ];
   checkResult( dbcl, null, null, expRecs, { No: 1 } );
}