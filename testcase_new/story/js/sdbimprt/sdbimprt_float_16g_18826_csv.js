/************************************************************************
*@Description:  seqDB-18826:导入导出浮点数（%.16g，csv）
*@Author     :  2019-7-16  huangxiaoni
************************************************************************/

main( test );

function test ()
{
   var seqDBId = '18826_1';
   var csName = COMMCSNAME;
   var clName = "sdbimprt_" + seqDBId;
   var cl = readyCL( csName, clName );

   var importFile = tmpFileDir + seqDBId + ".csv";
   var exportFile = tmpFileDir + "sdbexprt_" + seqDBId + ".csv";
   initData( importFile );
   var expRecsNum = 73;
   var expImportRecs = initExpImportData();
   var expExportRecs = initExpExportData();
   var type = 'csv';

   // sdbimprt   
   var importFields = 'a int, b'
   var rcResults = importData( csName, clName, importFile, type, importFields );
   checkImportRC( rcResults, expRecsNum );
   checkCLData( cl, expRecsNum, expImportRecs );

   // sdbexprt   
   var exportFields = 'a, b';
   var sort = '{a:1}';
   var otherParam = ' --floatfmt %.16g';
   exportData( csName, clName, exportFile, type, exportFields, sort, otherParam );
   checkExportData( exportFile, expExportRecs );

   cleanCL( csName, clName );
}

function initData ( importFile )
{

   var file = fileInit( importFile );
   file.write( "1," + "-2.78" + "\n" );
   file.write( "2," + "2.78" + "\n" );

   file.write( "3," + "-9223372036854775808" + "\n" );
   file.write( "4," + "9223372036854775807" + "\n" );

   file.write( "5," + "-9223372036854775809" + "\n" );
   file.write( "6," + "9223372036854775808" + "\n" );

   // significant figures number( rfNum ) <= 15, e.g: 1 / 10 / 15
   // -1e-17, rfNum: 1
   file.write( "7," + "-0.00000000000000001" + "\n" );
   //  1e-17
   file.write( "8," + "0.00000000000000001" + "\n" );
   // -1e-18
   file.write( "9," + "-0.000000000000000001" + "\n" );
   //  1e-18
   file.write( "10," + "0.000000000000000001" + "\n" );
   // rfNum: 10 
   file.write( "11," + "00000000000000000003.14159265300000000000000000000000000" + "\n" );
   // rfNum: 15
   file.write( "12," + "-0.12345678901234" + "\n" );
   file.write( "13," + "0.12345678901234" + "\n" );
   file.write( "14," + "-0.0000000000000000012345678901234" + "\n" );
   file.write( "15," + "0.0000000000000000012345678901234" + "\n" );

   // significant figures number > 15, e.g: 16
   file.write( "16," + "-0.1234567890123456" + "\n" );
   file.write( "17," + "0.1234567890123456" + "\n" );
   file.write( "18," + "-0.0000000000000001234567890123456" + "\n" );
   file.write( "19," + "0.0000000000000001234567890123456" + "\n" );

   // exponents number( eptNum ) <= 308, e.g: 1 / 308
   // eptNum: 1
   file.write( "20," + "0.1" + "\n" );
   file.write( "21," + "1e" + "\n" );
   // eptNum: 308
   file.write( "22," + "-1.7E+308" + "\n" );
   file.write( "23," + "1.7E+308" + "\n" );
   file.write( "24," + "-0.17E+309" + "\n" );
   file.write( "25," + "0.17E+309" + "\n" );
   // -1e-308
   file.write( "26," + "-0.0017e-305" + "\n" );
   file.write( "27," + "-0.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001" + "\n" );
   // 1e-308
   file.write( "28," + "0.0017e-305" + "\n" );
   file.write( "29," + "0.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001" + "\n" );
   // -1.7e+308
   file.write( "30," + "-0.0017e+311" + "\n" );
   file.write( "31," + "-170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" + "\n" );
   // 1.7e+308
   file.write( "32," + "0.0017e+311" + "\n" );
   file.write( "33," + "170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" + "\n" );

   // exponents number > 308, e.g: 309
   file.write( "34," + "-1.7e+309" + "\n" );
   file.write( "35," + "1.7e+309" + "\n" );
   file.write( "36," + "-0.0017e+312" + "\n" );
   file.write( "37," + "0.0017e+312" + "\n" );
   // -1.8e+308
   file.write( "38," + "-18000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" + "\n" );
   // 1.8e+308
   file.write( "39," + "18000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" + "\n" );
   // -1.7e+309
   file.write( "40," + "-170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" + "\n" );
   // 1.7e+309
   file.write( "41," + "170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" + "\n" );

   // others, float
   // 1.8e-309
   file.write( "42," + "0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018" + "\n" );
   // 1.8e-323
   file.write( "43," + "0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018" + "\n" );

   // jira-4711, cover follow data, and other data see above data
   file.write( "51," + "3.14" + "\n" );
   file.write( "52," + "3.140" + "\n" );
   file.write( "53," + "3.1400" + "\n" );
   file.write( "54," + "3.14000" + "\n" );
   file.write( "55," + "3.140000" + "\n" );
   file.write( "56," + "3.1400000" + "\n" );
   file.write( "57," + "3.14000000" + "\n" );
   file.write( "58," + "3.140000000" + "\n" );
   file.write( "59," + "3.1400000000" + "\n" );
   file.write( "60," + "3.14000000000" + "\n" );
   file.write( "61," + "3.140000000000" + "\n" );
   file.write( "62," + "3.1400000000000" + "\n" );
   file.write( "63," + "3.14000000000000" + "\n" );
   file.write( "64," + "3.140000000000000" + "\n" );
   file.write( "65," + "3.1400000000000000" + "\n" );
   file.write( "66," + "3.14000000000000000" + "\n" );
   file.write( "67," + "3.140000000000000000" + "\n" );
   file.write( "68," + "3.14000000000000000000000000000000000" + "\n" );
   file.write( "69," + "3.14000000000000000000000000000000000000000000000000000000000" + "\n" );
   // 3.14e-308
   file.write( "70," + "3.14000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" + "\n" );

   // valid int number: 15
   file.write( "80," + "-000000000000000123456789012345.000000000000000" + "\n" );
   file.write( "81," + " 000000000000000123456789012345.000000000000000" + "\n" );
   file.write( "82," + "-000000000000000.123456789012345000000000000000" + "\n" );
   file.write( "83," + " 000000000000000.123456789012345000000000000000" + "\n" );
   file.write( "84," + " 00000000000000012345.6789012345000000000000000" + "\n" );
   // num: 16
   file.write( "85," + "-00000000000000001234567890123456.0000000000000000" + "\n" );
   file.write( "86," + " 00000000000000001234567890123456.0000000000000000" + "\n" );
   file.write( "87," + "-0000000000000000.12345678901234560000000000000000" + "\n" );
   file.write( "88," + " 0000000000000000.12345678901234560000000000000000" + "\n" );
   file.write( "89," + " 000000000000000012345.678901234560000000000000000" + "\n" );

   file.close();
}

function initExpImportData ()
{

   var expB1 = '3.14';
   var expRecs = '[{"a":1,"b":-2.78},{"a":2,"b":2.78},{"a":3,"b":{"$numberLong":"-9223372036854775808"}},{"a":4,"b":{"$numberLong":"9223372036854775807"}},{"a":5,"b":{"$decimal":"-9223372036854775809"}},{"a":6,"b":{"$decimal":"9223372036854775808"}},{"a":7,"b":-1e-17},{"a":8,"b":1e-17},{"a":9,"b":-1e-18},{"a":10,"b":1e-18},{"a":11,"b":3.141592653},{"a":12,"b":-0.12345678901234},{"a":13,"b":0.12345678901234},{"a":14,"b":-1.2345678901234e-18},{"a":15,"b":1.2345678901234e-18},{"a":16,"b":{"$decimal":"-0.1234567890123456"}},{"a":17,"b":{"$decimal":"0.1234567890123456"}},{"a":18,"b":{"$decimal":"-0.0000000000000001234567890123456"}},{"a":19,"b":{"$decimal":"0.0000000000000001234567890123456"}},{"a":20,"b":0.1},{"a":21,"b":1},{"a":22,"b":-1.7e+308},{"a":23,"b":1.7e+308},{"a":24,"b":-1.7e+308},{"a":25,"b":1.7e+308},{"a":26,"b":-1.7e-308},{"a":27,"b":-1e-308},{"a":28,"b":1.7e-308},{"a":29,"b":1e-308},{"a":30,"b":-1.7e+308},{"a":31,"b":{"$decimal":"-170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"}},{"a":32,"b":1.7e+308},{"a":33,"b":{"$decimal":"170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"}},{"a":34,"b":{"$decimal":"-1700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"}},{"a":35,"b":{"$decimal":"1700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"}},{"a":36,"b":{"$decimal":"-1700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"}},{"a":37,"b":{"$decimal":"1700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"}},{"a":38,"b":{"$decimal":"-18000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"}},{"a":39,"b":{"$decimal":"18000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"}},{"a":40,"b":{"$decimal":"-170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"}},{"a":41,"b":{"$decimal":"170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"}},{"a":42,"b":{"$decimal":"0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018"}},{"a":43,"b":{"$decimal":"0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018"}},{"a":51,"b":' + expB1 + '},{"a":52,"b":' + expB1 + '},{"a":53,"b":' + expB1 + '},{"a":54,"b":' + expB1 + '},{"a":55,"b":' + expB1 + '},{"a":56,"b":' + expB1 + '},{"a":57,"b":' + expB1 + '},{"a":58,"b":' + expB1 + '},{"a":59,"b":' + expB1 + '},{"a":60,"b":' + expB1 + '},{"a":61,"b":' + expB1 + '},{"a":62,"b":' + expB1 + '},{"a":63,"b":' + expB1 + '},{"a":64,"b":' + expB1 + '},{"a":65,"b":' + expB1 + '},{"a":66,"b":' + expB1 + '},{"a":67,"b":' + expB1 + '},{"a":68,"b":' + expB1 + '},{"a":69,"b":' + expB1 + '},{"a":70,"b":' + expB1 + '},{"a":80,"b":-123456789012345},{"a":81,"b":123456789012345},{"a":82,"b":-0.123456789012345},{"a":83,"b":0.123456789012345},{"a":84,"b":12345.6789012345},{"a":85,"b":{"$decimal":"-1234567890123456.0000000000000000"}},{"a":86,"b":{"$decimal":"1234567890123456.0000000000000000"}},{"a":87,"b":{"$decimal":"-0.12345678901234560000000000000000"}},{"a":88,"b":{"$decimal":"0.12345678901234560000000000000000"}},{"a":89,"b":{"$decimal":"12345.678901234560000000000000000"}}]';

   return expRecs;
}

function initExpExportData ()
{

   var expB1 = '3.14';
   var expRecs = '[\"a,b\",\"1,-2.78\",\"2,2.78\",\"3,-9223372036854775808\",\"4,9223372036854775807\",\"5,-9223372036854775809\",\"6,9223372036854775808\",\"7,-1e-17\",\"8,1e-17\",\"9,-1e-18\",\"10,1e-18\",\"11,3.141592653\",\"12,-0.12345678901234\",\"13,0.12345678901234\",\"14,-1.2345678901234e-18\",\"15,1.2345678901234e-18\",\"16,-0.1234567890123456\",\"17,0.1234567890123456\",\"18,-0.0000000000000001234567890123456\",\"19,0.0000000000000001234567890123456\",\"20,0.1\",\"21,1.0\",\"22,-1.7e+308\",\"23,1.7e+308\",\"24,-1.7e+308\",\"25,1.7e+308\",\"26,-1.7e-308\",\"27,-9.999999999999999e-309\",\"28,1.7e-308\",\"29,9.999999999999999e-309\",\"30,-1.7e+308\",\"31,-170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"32,1.7e+308\",\"33,170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"34,-1700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"35,1700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"36,-1700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"37,1700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"38,-18000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"39,18000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"40,-170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"41,170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"42,0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018\",\"43,0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018\",\"51,' + expB1 + '\",\"52,' + expB1 + '\",\"53,' + expB1 + '\",\"54,' + expB1 + '\",\"55,' + expB1 + '\",\"56,' + expB1 + '\",\"57,' + expB1 + '\",\"58,' + expB1 + '\",\"59,' + expB1 + '\",\"60,' + expB1 + '\",\"61,' + expB1 + '\",\"62,' + expB1 + '\",\"63,' + expB1 + '\",\"64,' + expB1 + '\",\"65,' + expB1 + '\",\"66,' + expB1 + '\",\"67,' + expB1 + '\",\"68,' + expB1 + '\",\"69,' + expB1 + '\",\"70,' + expB1 + '\",\"80,-123456789012345.0\",\"81,123456789012345.0\",\"82,-0.123456789012345\",\"83,0.123456789012345\",\"84,12345.6789012345\",\"85,-1234567890123456.0000000000000000\",\"86,1234567890123456.0000000000000000\",\"87,-0.12345678901234560000000000000000\",\"88,0.12345678901234560000000000000000\",\"89,12345.678901234560000000000000000\",\"\"]';

   return expRecs;
}