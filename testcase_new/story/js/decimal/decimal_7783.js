/************************************
*@Description: range split for decimal data,verify two part function:
               part1:split condition is int type,and insert decimal data;
               part2:split condition is decimal type,and insert decimal data;
               need argument COORDSVCNAME
*@author:      zhaoyu
*@createdate:  2016.4.27
**************************************/
main( test )
function test ()
{
   var clName = COMMCLNAME + "_7783";
   //part1:split condition is int type,and insert decimal data;
   commDropCL( db, COMMCSNAME, clName );

   //check test environment before split
   //standalone can not split
   if( true == commIsStandalone( db ) )
   {
      return;
   }
   //less two groups,can not split
   var allGroupName = getGroupName( db );
   if( 1 === allGroupName.length )
   {
      return;
   }

   //create cl for range split
   var ClOption = { ShardingKey: { "age": 1 }, ShardingType: "range" };
   var dbcl = commCreateCL( db, COMMCSNAME, clName, ClOption, true, true );

   //insert decimal data befor split;
   var doc = [{ age: { $decimal: "123" } },
   { age: { $decimal: "123", $precision: [10, 2] } },
   { age: 123 },
   { age: "123" },
   { age: { $numberLong: "123" } },
   { age: 123.5687 },
   { age: { $decimal: "123.5687", $precision: [10, 4] } },
   { age: { $decimal: "123.5687" } },
   { age: 0 },
   { age: { $decimal: "0" } },
   { age: { $decimal: "0", $precision: [10, 5] } },
   { age: { $decimal: "-5.94E-400" } },
   { age: { $decimal: "6.94E-500" } },
   { age: { $decimal: "-1.99E+700" } },
   { age: { $decimal: "2.99E+600" } },
   { age: { $decimal: "9" } },
   { age: { $decimal: "10" } },
   { age: { $decimal: "9999" } },
   { age: { $decimal: "10000" } },
   { age: { $oid: "123abcd00ef12358902300ef" } },
   { age: { $date: "2000-01-01" } },
   { age: { $timestamp: "2000-01-01-15.32.18.000000" } },
   { age: { $binary: "aGVsbG8gd29ybGQ=", "$type": "1" } },
   { age: { $regex: "^z", "$options": "i" } },
   { age: null },
   { age: "abc" },
   { age: MinKey() },
   { age: MaxKey() },
   { age: true },
   { age: false },
   { age: { name: "zhang" } },
   { age: [1, 2, 3] }];
   dbcl.insert( doc );

   //split cl
   startCondition = { age: 10 };
   endCondition = { age: 10000 };
   splitGrInfo = ClSplitOneTimes( COMMCSNAME, clName, startCondition, endCondition );

   //check decimal data in src group and des group 
   expRecs = [[{ "age": "123" },
   { "age": 0 },
   { "age": { "$decimal": "0" } },
   { "age": { "$decimal": "0.00000", "$precision": [10, 5] } },
   { "age": { "$decimal": "-0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000594" } },
   { "age": { "$decimal": "0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000694" } },
   { "age": { "$decimal": "-19900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { "age": { "$decimal": "2990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { "age": { "$decimal": "9" } },
   { "age": { "$decimal": "10000" } },
   { age: { $oid: "123abcd00ef12358902300ef" } },
   { age: { $date: "2000-01-01" } },
   { age: { $timestamp: "2000-01-01-15.32.18.000000" } },
   { age: { $binary: "aGVsbG8gd29ybGQ=", "$type": "1" } },
   { age: { $regex: "^z", "$options": "i" } },
   { age: null },
   { age: "abc" },
   { age: { $minKey: 1 } },
   { age: { $maxKey: 1 } },
   { age: true },
   { age: false },
   { age: { name: "zhang" } },
   { age: [1, 2, 3] }],
   [{ "age": { "$decimal": "123" } },
   { "age": { "$decimal": "123.00", "$precision": [10, 2] } },
   { "age": 123 },
   { "age": 123 },
   { "age": 123.5687 },
   { "age": { "$decimal": "123.5687", "$precision": [10, 4] } },
   { "age": { "$decimal": "123.5687" } },
   { age: { "$decimal": "10" } },
   { "age": { "$decimal": "9999" } }]];
   checkRangeClSplitResult( db, clName, splitGrInfo, null, null, expRecs, { _id: 1 } );

   //insert decimal data after split
   doc1 = [{ age: { $decimal: "1000" } },
   { age: { $decimal: "1000", $precision: [10, 5] } },
   { age: 1000 },
   { age: { $decimal: "5", $precision: [5, 2] } },
   { age: { $decimal: "100000", $precision: [10, 2] } },
   { age: { $oid: "123abcd00ef12358902300ef" } },
   { age: { $date: "2000-01-01" } },
   { age: { $timestamp: "2000-01-01-15.32.18.000000" } },
   { age: { $binary: "aGVsbG8gd29ybGQ=", "$type": "1" } },
   { age: { $regex: "^z", "$options": "i" } },
   { age: null },
   { age: "abc" },
   { age: MinKey() },
   { age: MaxKey() },
   { age: true },
   { age: false },
   { age: { name: "zhang" } }];
   dbcl.insert( doc1 );

   //check decimal data in src group and des group
   expRecs1 = [[{ "age": "123" },
   { "age": 0 },
   { "age": { "$decimal": "0" } },
   { "age": { "$decimal": "0.00000", "$precision": [10, 5] } },
   { "age": { "$decimal": "-0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000594" } },
   { "age": { "$decimal": "0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000694" } },
   { "age": { "$decimal": "-19900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { "age": { "$decimal": "2990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { "age": { "$decimal": "9" } },
   { "age": { "$decimal": "10000" } },
   { age: { $oid: "123abcd00ef12358902300ef" } },
   { age: { $date: "2000-01-01" } },
   { age: { $timestamp: "2000-01-01-15.32.18.000000" } },
   { age: { $binary: "aGVsbG8gd29ybGQ=", "$type": "1" } },
   { age: { $regex: "^z", "$options": "i" } },
   { age: null },
   { age: "abc" },
   { age: { $minKey: 1 } },
   { age: { $maxKey: 1 } },
   { age: true },
   { age: false },
   { age: { name: "zhang" } },
   { age: [1, 2, 3] },
   { age: { $decimal: "5.00", $precision: [5, 2] } },
   { age: { $decimal: "100000.00", $precision: [10, 2] } },
   { age: { $oid: "123abcd00ef12358902300ef" } },
   { age: { $date: "2000-01-01" } },
   { age: { $timestamp: "2000-01-01-15.32.18.000000" } },
   { age: { $binary: "aGVsbG8gd29ybGQ=", "$type": "1" } },
   { age: { $regex: "^z", "$options": "i" } },
   { age: null },
   { age: "abc" },
   { age: { $minKey: 1 } },
   { age: { $maxKey: 1 } },
   { age: true },
   { age: false },
   { age: { name: "zhang" } }],
   [{ "age": { "$decimal": "123" } },
   { "age": { "$decimal": "123.00", "$precision": [10, 2] } },
   { "age": 123 },
   { "age": 123 },
   { "age": 123.5687 },
   { "age": { "$decimal": "123.5687", "$precision": [10, 4] } },
   { "age": { "$decimal": "123.5687" } },
   { age: { "$decimal": "10" } },
   { "age": { "$decimal": "9999" } },
   { age: { $decimal: "1000" } },
   { age: { $decimal: "1000.00000", $precision: [10, 5] } },
   { age: 1000 }]];
   checkRangeClSplitResult( db, clName, splitGrInfo, null, null, expRecs1, { _id: 1 } );

   //part2:split condition is decimal type,and insert decimal data;
   commDropCL( db, COMMCSNAME, clName, true, true, "drop CL in the beginning" );

   //create cl for range split
   var ClOption = { ShardingKey: { "age": 1 }, ShardingType: "range" };
   var dbcl = commCreateCL( db, COMMCSNAME, clName, ClOption, true, true );

   //insert decimal data befor split;
   var doc = [{ age: { $decimal: "123" } },
   { age: { $decimal: "123", $precision: [10, 2] } },
   { age: 123 },
   { age: "123" },
   { age: { $numberLong: "123" } },
   { age: 123.5687 },
   { age: { $decimal: "123.5687", $precision: [10, 4] } },
   { age: { $decimal: "123.5687" } },
   { age: 0 },
   { age: { $decimal: "0" } },
   { age: { $decimal: "0", $precision: [10, 5] } },
   { age: { $decimal: "-5.94E-400" } },
   { age: { $decimal: "6.94E-500" } },
   { age: { $decimal: "-1.99E+700" } },
   { age: { $decimal: "2.99E+600" } },
   { age: { $decimal: "9" } },
   { age: { $decimal: "10" } },
   { age: { $decimal: "9999" } },
   { age: { $decimal: "10000" } },
   { age: { $oid: "123abcd00ef12358902300ef" } },
   { age: { $date: "2000-01-01" } },
   { age: { $timestamp: "2000-01-01-15.32.18.000000" } },
   { age: { $binary: "aGVsbG8gd29ybGQ=", "$type": "1" } },
   { age: { $regex: "^z", "$options": "i" } },
   { age: null },
   { age: "abc" },
   { age: MinKey() },
   { age: MaxKey() },
   { age: true },
   { age: false },
   { age: { name: "zhang" } },
   { age: [1, 2, 3] }];
   dbcl.insert( doc );

   //split cl
   startCondition = { age: { $decimal: "10" } };
   endCondition = { age: { $decimal: "10000", $precision: [7, 2] } };
   splitGrInfo = ClSplitOneTimes( COMMCSNAME, clName, startCondition, endCondition );

   //check decimal data in src group and des group 
   expRecs = [[{ "age": "123" },
   { "age": 0 },
   { "age": { "$decimal": "0" } },
   { "age": { "$decimal": "0.00000", "$precision": [10, 5] } },
   { "age": { "$decimal": "-0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000594" } },
   { "age": { "$decimal": "0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000694" } },
   { "age": { "$decimal": "-19900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { "age": { "$decimal": "2990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { "age": { "$decimal": "9" } },
   { "age": { "$decimal": "10000" } },
   { age: { $oid: "123abcd00ef12358902300ef" } },
   { age: { $date: "2000-01-01" } },
   { age: { $timestamp: "2000-01-01-15.32.18.000000" } },
   { age: { $binary: "aGVsbG8gd29ybGQ=", "$type": "1" } },
   { age: { $regex: "^z", "$options": "i" } },
   { age: null },
   { age: "abc" },
   { age: { $minKey: 1 } },
   { age: { $maxKey: 1 } },
   { age: true },
   { age: false },
   { age: { name: "zhang" } },
   { age: [1, 2, 3] }],
   [{ "age": { "$decimal": "123" } },
   { "age": { "$decimal": "123.00", "$precision": [10, 2] } },
   { "age": 123 },
   { "age": 123 },
   { "age": 123.5687 },
   { "age": { "$decimal": "123.5687", "$precision": [10, 4] } },
   { "age": { "$decimal": "123.5687" } },
   { age: { "$decimal": "10" } },
   { "age": { "$decimal": "9999" } }]];
   checkRangeClSplitResult( db, clName, splitGrInfo, null, null, expRecs, { _id: 1 } );

   //insert decimal data after split
   doc1 = [{ age: { $decimal: "1000" } },
   { age: { $decimal: "1000", $precision: [10, 5] } },
   { age: 1000 },
   { age: { $decimal: "5", $precision: [5, 2] } },
   { age: { $decimal: "100000", $precision: [10, 2] } },
   { age: { $oid: "123abcd00ef12358902300ef" } },
   { age: { $date: "2000-01-01" } },
   { age: { $timestamp: "2000-01-01-15.32.18.000000" } },
   { age: { $binary: "aGVsbG8gd29ybGQ=", "$type": "1" } },
   { age: { $regex: "^z", "$options": "i" } },
   { age: null },
   { age: "abc" },
   { age: MinKey() },
   { age: MaxKey() },
   { age: true },
   { age: false },
   { age: { name: "zhang" } }];
   dbcl.insert( doc1 );

   //check decimal data in src group and des group
   expRecs1 = [[{ "age": "123" },
   { "age": 0 },
   { "age": { "$decimal": "0" } },
   { "age": { "$decimal": "0.00000", "$precision": [10, 5] } },
   { "age": { "$decimal": "-0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000594" } },
   { "age": { "$decimal": "0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000694" } },
   { "age": { "$decimal": "-19900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { "age": { "$decimal": "2990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" } },
   { "age": { "$decimal": "9" } },
   { "age": { "$decimal": "10000" } },
   { age: { $oid: "123abcd00ef12358902300ef" } },
   { age: { $date: "2000-01-01" } },
   { age: { $timestamp: "2000-01-01-15.32.18.000000" } },
   { age: { $binary: "aGVsbG8gd29ybGQ=", "$type": "1" } },
   { age: { $regex: "^z", "$options": "i" } },
   { age: null },
   { age: "abc" },
   { age: { $minKey: 1 } },
   { age: { $maxKey: 1 } },
   { age: true },
   { age: false },
   { age: { name: "zhang" } },
   { age: [1, 2, 3] },
   { age: { $decimal: "5.00", $precision: [5, 2] } },
   { age: { $decimal: "100000.00", $precision: [10, 2] } },
   { age: { $oid: "123abcd00ef12358902300ef" } },
   { age: { $date: "2000-01-01" } },
   { age: { $timestamp: "2000-01-01-15.32.18.000000" } },
   { age: { $binary: "aGVsbG8gd29ybGQ=", "$type": "1" } },
   { age: { $regex: "^z", "$options": "i" } },
   { age: null },
   { age: "abc" },
   { age: { $minKey: 1 } },
   { age: { $maxKey: 1 } },
   { age: true },
   { age: false },
   { age: { name: "zhang" } }],
   [{ "age": { "$decimal": "123" } },
   { "age": { "$decimal": "123.00", "$precision": [10, 2] } },
   { "age": 123 },
   { "age": 123 },
   { "age": 123.5687 },
   { "age": { "$decimal": "123.5687", "$precision": [10, 4] } },
   { "age": { "$decimal": "123.5687" } },
   { age: { "$decimal": "10" } },
   { "age": { "$decimal": "9999" } },
   { age: { $decimal: "1000" } },
   { age: { $decimal: "1000.00000", $precision: [10, 5] } },
   { age: 1000 }]];
   checkRangeClSplitResult( db, clName, splitGrInfo, null, null, expRecs1, { _id: 1 } );
   commDropCL( db, COMMCSNAME, clName );
}

